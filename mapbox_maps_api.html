<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>First Mapbox Map</title>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css' rel='stylesheet' />

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/4d0b40d330.js" crossorigin="anonymous"></script>
    <!-- Custom CSS -->
    <style>
        #map {
            width: 100%;
            height: 500px;
        }
        .mapboxgl-ctrl-logo, .mapboxgl-ctrl {
            opacity: 20%;
        }
        .mapboxgl-ctrl-logo, .mapboxgl-ctrl:hover {
            opacity: 100%;
        }
        .mapboxgl-popup-content {
            /*display: flex;*/
        }
    </style>
</head>
<body class="bg-dark m-3">

<h1 class="text-white text-center pb-3">Jeremy's Favorite Restaurants</h1>

<div class="border border-2 border-white rounded-3" id='map'></div>
<!--<div class="buttonContainer d-flex">-->
<!--    <button type="button" id="zoom-5" class="zoomBtn border border-2 border-light btn btn-secondary mt-3 px-3 flex-fill">Zoom 5</button>-->
<!--    <button type="button" id="zoom-10" class="zoomBtn border border-2 border-light btn btn-secondary mt-3 px-3 flex-fill">Zoom 10</button>-->
<!--    <button type="button" id="zoom-15" class="zoomBtn border border-2 border-light btn btn-secondary mt-3 px-3 flex-fill">Zoom 15</button>-->
<!--</div>-->
<div class="restaurants"></div>


<!--can use form group , label and select-->


<!-- Mapbox JS -->
<script src='https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js'></script>
<script src='js/jquery-3.6.3.js'></script>
<script src="js/mapbox-geocoder-utils.js"></script>
<script src="js/key.js"></script>

<script>
    $(document).ready(function () {
        // const accessToken = MAPBOX_API_KEY;

        //add ratings and font awesome starts
        const restaurants = [
            {
                "name": "Erick's Tacos",
                "latitude": "29.55630792947087",
                "longitude": "-98.40105750025616",
                "description": "Traditional Mexican eats, including tacos & quesadillas, in the casual dining room or outdoor stand.",
                "image": "ericks-tacos.jpeg"

            },
            {
                "name": "Taquitos West Avenue",
                "latitude": "29.487106040732325",
                "longitude": "-98.52591151132648",
                "description": "Mexican, counter-service pit stop turning out an array of tacos in easygoing surroundings.",
                "image": "taquitos-west.jpeg"
            },
            {
                "name": "The Magnolia Pancake Haus",
                "latitude": "29.542995696236634",
                "longitude": "-98.58451866614952",
                "description": "Popular mainstay known for its ample breakfast options, plus a lunch menu served in homey surrounds.",
                "image": "magnolia-pancakehauss.jpeg"

            },
            // {
            //     "name": "name",
            //     "latitude": "latitude",
            //     "longitude": "longitude",
            //     "description": "description",
            //     "image": ""

        // },
        ]

        mapboxgl.accessToken = MAPBOX_API_KEY;

        //zoom to, fly too selectors
        let zoomFactor = 10;
            // console.log(`zoomFactor default: ${zoomFactor}`);

        //add lat centroid for zoom center
        //possible to create bounding box?
        // add boot strap incremented slider

        $("#zoom-5").click(function () {
            zoomFactor = 5;
            // console.log(`zoomFactor ${zoomFactor}`);
        });

        $("#zoom-10").click(function () {
            zoomFactor = 10;
            // console.log(`zoomFactor ${zoomFactor}`);
        });

        $("#zoom-15").click(function () {
            zoomFactor = 15;
            // console.log(`zoomFactor ${zoomFactor}`);
        });

        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/dark-v10',
            zoom: zoomFactor,
            center: [-98.50883441005111, 29.546409654952484]
            // center: restaurants[0].latitude,restaurants[0].longitude
        });

        // const marker = new mapboxgl.Marker();
        // marker.setLngLat([-98.40105750025616, 29.55630792947087]);
        // marker.addTo(map);

        // let htmlString = "";
        // let popupMessage = "";


        //would like to crop card img to 16x9
        restaurants.forEach(function (restaurant) {
            const popup = new mapboxgl.Popup()
            .setHTML(`
                <div class="card w-100">
                      <img src="image/${restaurant.image}" class="card-img-top" alt="...">
                    <div class="card-body">
                        <p class="fs-6">${restaurant.name}</p>
                        <p class="card-text">${restaurant.description}</p>
                    </div>
                </div>

            `);

            const marker = new mapboxgl.Marker({"color": "red"});
            marker.setLngLat([restaurant.longitude, restaurant.latitude]);
            marker.addTo(map);

            marker.setPopup(popup);

            //call function described below
            // makePinForRestaurant(restaurant)

            // print cards of restaurants
            // htmlString += `
            //     <div class='restaurantList my-2 p-2 border border-2 border-white rounded-3'>
            //         <p class="text-white fs-4">${restaurant.name}:</p>
            //         <p class="text-white m-0">Lat: &nbsp&nbsp&nbsp&nbsp&nbsp${restaurant.latitude}</p>
            //         <p class="text-white m-0">Long: ${restaurant.longitude}</p>
            //         <p class="text-white m-0 pt-2">${restaurant.description}</p>
            //     </div>
            //         `;
            // $(".restaurants").html(htmlString);
        });

        //class doesn't add
        // $("div.mapboxgl-popup-content").addClass("d-flex");

        // makePinForRestaurant(

        // function pinThatAddress(address) {
        //     geocode(address, MAPBOX_API_KEY).then(function (address) {
        //         const marker = new mapboxgl.Marker();
        //         marker.setLngLat(address);
        //         marker.addTo(map);
        //     });
        // }

        //create loop
        //set init time
        //set duration between
        //create array of locations
        // setTimeout(()=> {
        //     pinThatAddress('alamo heights');
        //     },500);
        // setTimeout(()=> {
        //     pinThatAddress('kirby');
        //     },300);
        // setTimeout(()=> {
        //     pinThatAddress('converse');
        //     },400);
        // setTimeout(()=> {
        //     pinThatAddress('schertz');
        //     },500);

        map.addControl(new mapboxgl.NavigationControl());
    });

</script>
</body>
</html>